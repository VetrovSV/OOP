# Создание программ с GUI

Некоторые фреимворки для чистого C++ для создания приложений с GUI
-  Qt (кроссплатформенный: Linux, Windows, MacOS, Android) [https://raw.githubusercontent.com/VetrovSV/OOP/master/Qt_lec1.pdf]
-  wxWidgets (кроссплатформенный: Linux, Windows, MacOS)
-  UWP (Windows)
-  WindowsForms (устарел, Windows)


Для диалекта под названием C++\CLI есть возможность использовать UWP и WPF. Этот диалект языка, может компилироваться в байт-код виртуальной машины, которая исполняет программы в частности на C#. Есть возможность использовать библиотеки .NET.
Однако, диалект местами существенно отличается от стандартного C++ и не имеет широкого распространения.


# Приложение на основе WinRT и UWP (XAML)

Создано в VS 2022 по шаблону: Blank App (C++ / WinRT)

![](new_WinRT.jpg)

IDE может указывать на большое число синтаксических ошибок. Они пропадают после первой компиляции проекта.

#### Файлы проекта
- `CppWinRTUWP.sln` - файл решения (solution)
- `CppWinRTUWP.vcxproj` - файл проекта (project)
- `App.h`, `App.cpp` - файл с описанием главного класса приложения, содержит аналог функции main
- `MainPage.h`, `MainPage.h` - файлы с описанием класса (struct) главного окна
- `MainPage.xaml` - описания пользовательского интерфейса главного окна; можно редактирвоать в дизайнере интерфейса или как текстовый xml файл
- `MainPage.idl` - классы локальной среды выполнения, на которые нужно сослаться в XAML файлах
- `pch.h` - файл содержащий директивы include для файлов, которые редко изменяются и которые можно скомпилировать заранее (из `pch.cpp` файла)
- `bank.h` - файл с основной логикой приложения, добавлен вручную


#### Устройство проекта
Основные классы приложения

![](UPW-prog.drawio.png)

Для доступа к элементам интерфейса из класса окна MainPage нужно вызывать методы, которые возвращают ссылки на объекты, представляющие элементы интерфейса. Например
```c++
// вызов метода, который вернёт ссылку на объект,
// представляющий поле ввода с именем textbox_sum
// textbox_sum().Text()

string sumt = to_string( textbox_sum().Text() );

// содержимое поля ввода представленно типом данных hstring
// для преобразования в std::string вызываем функцию to_string
```

Каждый элемент интерфейса описан в XAML файле окна. Например
```xml
 <TextBox
          x:Name="textbox_sum"                                   имя элемента интерфейса
          HorizontalAlignment="Left" VerticalAlignment="Top"     привязка к левой и верхней границе окна
          Margin="010,30,0,0"                                    поля вокруг объекта
          Text="100000"                                          содержимое поля ввода
          TextWrapping="Wrap"                                    настройка переноса текста
          />
```

Задание свойств элементов интерфейса в C++ коде
```c++
textbox_sum().Text( "new text" );
```

#### Дизайнер UI

![](https://github.com/VetrovSV/OOP/raw/master/examples/Cpp_WinRT_UWP/WPF%20app%20in%20VS.png)

Создание обработчика события по умолчанию -- двойной клик на элементе интерфейса.
Для кнопки создаётся обработчик клика. Для поля ввода -- обработчик на изменение содержимого.

<img src="VS-XAML-components.png" width=420>

### Для компиляции должны быть установлены (VS Installer)
- [x] Разработка приложений для универсальной платформы Windows.
- [x] Средства инструментов универсальной платформы Windows для C++ (версии 14x)  \
на панели Сведения об установке - Разработка приложений для универсальной платформы Windows:
- Кроме того, в разделе Windows Параметры - Обновления Безопасность >> выберите параметр Режим разработчика вместо параметра Неопубликованные приложения.



#### Справка
- https://docs.microsoft.com/ru-ru/windows/uwp/cpp-and-winrt-apis/get-started
- Язык декларативного программирования XAML, В. В. Подбельский, 2018, 336 с.
